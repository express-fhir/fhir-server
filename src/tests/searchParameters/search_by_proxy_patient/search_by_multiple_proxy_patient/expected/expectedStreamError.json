{
  "entry": [
    {
      "resource": {
        "resourceType": "OperationOutcome",
        "issue": [
          {
            "severity": "error",
            "code": "internal",
            "details": {
              "text": "Unexpected: ResourcePreparer _transform: error: RethrownError: Error in enrichAsync(). id: b59f86b9-5307-506a-bb6c-3eb555ace521"
            },
            "diagnostics": "Error: Error while enriching\n    at IdEnrichmentProvider.<anonymous> (/home/ubuntu/Desktop/BWELL/fhir-server/src/tests/searchParameters/search_by_proxy_patient/search_by_multiple_proxy_patient/search_by_multiple_proxy_patient_stream_error.test.js:59:23)\n    at /home/ubuntu/Desktop/BWELL/fhir-server/node_modules/jest-mock/build/index.js:397:39\n    at IdEnrichmentProvider.<anonymous> (/home/ubuntu/Desktop/BWELL/fhir-server/node_modules/jest-mock/build/index.js:404:13)\n    at IdEnrichmentProvider.mockConstructor (/home/ubuntu/Desktop/BWELL/fhir-server/node_modules/jest-mock/build/index.js:148:19)\n    at EnrichmentManager.enrichAsync (/home/ubuntu/Desktop/BWELL/fhir-server/src/enrich/enrich.js:32:54)\n    at ResourcePreparer.enrichAsync [as prepareResourceAsync] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/common/resourcePreparer.js:135:68)\n    at ResourcePreparerTransform.prepareResourceAsync [as processChunkAsync] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/resourcePreparerTransform.js:149:38)\n    at processChunkAsync (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/resourcePreparerTransform.js:90:22)\n    at Array.map (<anonymous>)\n    at ResourcePreparerTransform.map [as _transform] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/resourcePreparerTransform.js:89:37)\n    at ResourcePreparerTransform.Transform._write (node:internal/streams/transform:175:8)\n    at writeOrBuffer (node:internal/streams/writable:392:12)\n    at _write (node:internal/streams/writable:333:10)\n    at ResourcePreparerTransform.Writable.write (node:internal/streams/writable:337:10)\n    at MongoReadableStream.ondata (node:internal/streams/readable:766:22)\n    at MongoReadableStream.emit (node:events:513:28)\n    at MongoReadableStream.emit (node:domain:552:15)\n    at addChunk (node:internal/streams/readable:324:12)\n    at readableAddChunk (node:internal/streams/readable:297:9)\n    at MongoReadableStream.Readable.push (node:internal/streams/readable:234:10)\n    at MongoReadableStream.push [as readAsync] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/mongoStreamReader.js:104:26)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at MongoReadableStream._read (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/mongoStreamReader.js:66:17)\r\nCauses: RethrownError: Error in enrichAsync()\n    at EnrichmentManager.enrichAsync (/home/ubuntu/Desktop/BWELL/fhir-server/src/enrich/enrich.js:41:19)\n    at ResourcePreparer.enrichAsync [as prepareResourceAsync] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/common/resourcePreparer.js:135:68)\n    at ResourcePreparerTransform.prepareResourceAsync [as processChunkAsync] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/resourcePreparerTransform.js:149:38)\n    at processChunkAsync (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/resourcePreparerTransform.js:90:22)\n    at Array.map (<anonymous>)\n    at ResourcePreparerTransform.map [as _transform] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/resourcePreparerTransform.js:89:37)\n    at ResourcePreparerTransform.Transform._write (node:internal/streams/transform:175:8)\n    at writeOrBuffer (node:internal/streams/writable:392:12)\n    at _write (node:internal/streams/writable:333:10)\n    at ResourcePreparerTransform.Writable.write (node:internal/streams/writable:337:10)\n    at MongoReadableStream.ondata (node:internal/streams/readable:766:22)\n    at MongoReadableStream.emit (node:events:513:28)\n    at MongoReadableStream.emit (node:domain:552:15)\n    at addChunk (node:internal/streams/readable:324:12)\n    at readableAddChunk (node:internal/streams/readable:297:9)\n    at MongoReadableStream.Readable.push (node:internal/streams/readable:234:10)\n    at MongoReadableStream.push [as readAsync] (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/mongoStreamReader.js:104:26)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at MongoReadableStream._read (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/mongoStreamReader.js:66:17)\r\nCauses: RethrownError: ResourcePreparer _transform: error: RethrownError: Error in enrichAsync(). id: b59f86b9-5307-506a-bb6c-3eb555ace521\n    at processChunksAsync (/home/ubuntu/Desktop/BWELL/fhir-server/src/operations/streaming/resourcePreparerTransform.js:97:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"
          }
        ]
      }
    },
    {
      "resource": {
        "resourceType": "Observation",
        "id": "b59f86b9-5307-506a-bb6c-3eb555ace522",
        "meta": {
          "versionId": "1",
          "lastUpdated": "2023-10-03T12:55:19.000Z",
          "source": "/patients",
          "security": [
            {
              "system": "https://www.icanbwell.com/owner",
              "code": "northwell"
            },
            {
              "system": "https://www.icanbwell.com/access",
              "code": "northwell"
            },
            {
              "system": "https://www.icanbwell.com/vendor",
              "code": "northwell"
            },
            {
              "system": "https://www.icanbwell.com/sourceAssigningAuthority",
              "code": "northwell"
            }
          ]
        },
        "identifier": [
          {
            "id": "sourceId",
            "system": "https://www.icanbwell.com/sourceId",
            "value": "b59f86b9-5307-506a-bb6c-3eb555ace522"
          },
          {
            "id": "uuid",
            "system": "https://www.icanbwell.com/uuid",
            "value": "b59f86b9-5307-506a-bb6c-3eb555ace522"
          }
        ],
        "status": "final",
        "code": {
          "coding": [
            {
              "system": "http://www.icanbwell.com/cql/library",
              "code": "BMI001"
            },
            {
              "system": "http://www.icanbwell.com/cql/libraryVersion",
              "code": "1.0.0"
            },
            {
              "system": "http://www.icanbwell.com/cql/rule",
              "code": "InAgeCohort"
            }
          ]
        },
        "subject": {
          "extension": [
            {
              "id": "sourceId",
              "url": "https://www.icanbwell.com/sourceId",
              "valueString": "Patient/northwell-2"
            },
            {
              "id": "uuid",
              "url": "https://www.icanbwell.com/uuid",
              "valueString": "Patient/dfd7cc6b-a5a3-5433-a5a5-3ac0d10a6572"
            },
            {
              "id": "sourceAssigningAuthority",
              "url": "https://www.icanbwell.com/sourceAssigningAuthority",
              "valueString": "northwell"
            }
          ],
          "reference": "Patient/person.54808e62-6445-4bb6-8f89-b2ed7e6865d2"
        },
        "effectivePeriod": {
          "start": "2021-01-01T00:00:00.000Z",
          "end": "2021-12-31T00:00:00.000Z"
        },
        "issued": "2021-01-01T12:00:00Z",
        "valueBoolean": false
      }
    }
  ],
  "resourceType": "Bundle",
  "type": "searchset",
  "total": 0
}
